<html>

<head>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.0.0/crypto-js.min.js"></script>
</head>

<body>
    <script>
        var token = "example"
        var captcha = ""
        async function sendData() {

            const response = await fetch('http://localhost:3000/generateCaptcha', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({
                    "token": token
                })
            });

            if (response.ok) {
                const data = await response.json();
                let element = document.getElementById('example');
                captcha = data.token;
                element.innerHTML = `<img src="http://localhost:3000/${data.image}"><br><input type="text" id="captcha" placeholder="Enter Captcha"><button onclick="validateCaptcha()">Validate Captcha</button>`;
                console.log('Response from server:', data);
            } else {
                console.error('Failed to send encrypted token:', response.statusText);
            }
        }

        async function validateCaptcha() {
            const response = await fetch('http://localhost:3000/validateCaptcha', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({
                    captchaToken: captcha,
                    token: token,
                    code: document.getElementById('captcha').value
                })
            });

            if (response.ok) {
                const data = await response.json();
                console.log('Response from server:', data);
            } else {
                console.error('Failed to send encrypted token:', response.statusText);
            }
        }
    </script>
    <button onclick="sendData()">Send Data</button>
    <div id="example">

    </div>
</body>

</html>